from PIL import Image
from io import BytesIO
import base64
import numpy as np

def add_tranpsarency(im, bg_colour=(255, 255, 255)):
    data = np.array(im)
    rgb = data[:,:,:3]
    black = [0, 0, 0, 0]
    mask = np.all(rgb == bg_colour, axis=-1)
    data[mask] = black
    return Image.fromarray(data)

def decode_img(string):
    return Image.open(BytesIO(base64.b64decode(string)))

def decode_and_scale(string):
    img = decode_img(string)
    img = img.convert('RGBA')
    img = add_tranpsarency(img)
    img = img.resize((28, 28), Image.NEAREST)
    img = np.mean(img, axis=2)
    # Image.fromarray(img).show()
    return np.array(img)

if __name__ == '__main__':
    test = '''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'''
    decode_and_scale(test)